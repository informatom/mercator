function webpageForm() {
  $('#webpageForm').w2form({
    name: 'webpageForm',
    url: 'contentmanager/front/manage_webpage/0',
    fields : [
      { field: 'title_de', type: 'text', required: true,
        html: { caption: '<%= I18n.t("attributes.title") %> DE' } },
      { field: 'title_en', type: 'text',
        html: { caption: '<%= I18n.t("attributes.title") %> EN' } },
      { field: 'url', type: 'text',
        html: { caption: 'URL' } },
      { field: 'slug', type: 'text',
        html: { caption: 'Slug' } },
      { field: 'position', type: 'int', required: true,
        html: { caption: '<%= I18n.t("attributes.position") %>' } },
      { field: 'page_template_id', type: 'list', required: true,
        options: {
          items: <%= PageTemplate.all.map {
            |page_template| {
              id:   page_template.id,
              text: page_template.name
            }
          }.to_json %>
        },
        html: { caption: '<%= I18n.t("attributes.page_template") %>' } }
    ],

    actions: {
      save: {
        caption: 'Save',
        class: 'w2ui-btn-green',
        onClick: function () {
          this.save(function(response) {
            new_id = response.record.recid.toString()
            w2ui.assignments.url = '/contentmanager/front/show_assignments/' + new_id
            w2ui.assignments.reload()
            var tree = $("#webpageTree").fancytree("getTree")
            tree.reload().done(function() {
              tree.activateKey(new_id).setExpanded()
            })
          })
        }
      },
      delete: {
        caption: 'Delete',
        class: 'w2ui-btn-red',
        onClick: function () {
          var active_node = $("#webpageTree").fancytree("getTree").getActiveNode()
          w2confirm('<%= I18n.t("mercator.are_you_sure") %>', function (button) {
            if (button =='Yes') {
              $.ajax({
                url:"/admin/webpages/" + active_node.key,
                method: "DELETE",
                data: { authenticity_token: csrf_token },
                dataType: 'script',
              }).done(function(response, textStatus, jqXHR) {
                $("#webpageTree").fancytree("getTree").reload()
                w2ui.webpageForm.clear()
                w2ui.webpageForm.refresh()
                $("#webpageTree").fancytree("getTree").reload()
              }).fail(function(jqXHR, textStatus, errorThrown) {
                w2alert(jqXHR.responseText)
              })
            }
          })
        }
      },
      create: {
        caption: 'Add New',
        class: 'w2ui-btn-orange',
        onClick: function () {
          var active_node = $("#webpageTree").fancytree("getTree").getActiveNode()
          this.clear()
          this.record['position'] = 0
          if (active_node) {
            this.record['parent_id'] = active_node.key
          }
          this.refresh()
        }
      }
    },
    postData: { authenticity_token: csrf_token }
  })
}